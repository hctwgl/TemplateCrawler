webpackJsonp([0],{232:function(e,t,a){function n(e){a(275)}var i=a(6)(a(255),a(288),n,null,null);e.exports=i.exports},238:function(e,t,a){"use strict";function n(e){return{get:function(t){return a.i(i.a)({url:e+"/"+t,method:"GET"})},page:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return a.i(i.a)({url:e+"/page",method:"GET",params:{page:t,size:n}})},query:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"name",l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;return a.i(i.a)({url:e+"/query",method:"GET",params:{q:t,field:n,page:l,size:o}})},add:function(t){return a.i(i.a)({url:e+"/add",method:"POST",data:t})},edit:function(t){return a.i(i.a)({url:e+"/edit",method:"PUT",data:t})},delete:function(t){return a.i(i.a)({url:e+"/delete/"+t,method:"DELETE",data:data})}}}a.d(t,"a",function(){return n});var i=a(84)},239:function(e,t,a){"use strict";function n(e){return/^[a-z0-9](?:[-_.+]?[a-z0-9]+)*@wallstreetcn\.com$/i.test(e.trim())}function i(e){return/^[A-Za-z0-9]+$/.test(e)}t.b=n,t.a=i},240:function(e,t,a){"use strict";var n=a(238),i=new n.a("/api/template");t.a=i},241:function(e,t,a){"use strict";var n=a(238),i=new n.a("/api/website");t.a=i},242:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"query-select",props:{api:{required:!0},field:{type:String,default:"name"},page:{type:Number,default:0},size:{type:Number,default:10}},data:function(){return{options:[],value:[],loading:!1,curData:null}},mounted:function(){},methods:{setData:function(e){e&&(this.curData=e,this.options=[e],this.value=e.id)},remoteMethod:function(e){var t=this;if(null!==e&&void 0!==e&&"string"==typeof e&&0!==e.length){if(this.curData&&this.curData.name===e)return void console.log("same data");console.log(e),e&&e.trim().length>0?(this.loading=!0,this.api.query(e).then(function(e){t.options=e.data.content,t.loading=!1})):this.options=[]}},onChange:function(e){if(e){if(this.curData&&this.curData.id===e)return void console.log("same data");console.log("change "+e);var t=this.options.find(function(t){return t.id=e});this.curData=t,this.$emit("change",t)}}}}},245:function(e,t,a){var n=a(6)(a(242),a(246),null,null,null);e.exports=n.exports},246:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-select",{attrs:{filterable:"",remote:"",placeholder:"搜索","remote-method":e.remoteMethod,loading:e.loading},on:{change:e.onChange},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))},staticRenderFns:[]}},255:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=(a(239),a(240)),l=a(241),o=a(245),r=a.n(o);t.default={name:"template-edit",computed:{},data:function(){return{formData:{username:"",password:"",authorities:null},loginRules:{domain:[{required:!0,trigger:"blur",validator:function(e,t,a){t.length<6?a(new Error("密码不能小于6位")):a()}}]},loading:!1,authorities:[],id:null,websiteApi:l.a,editPageName:"0",tabIndex:1,fieldType:[{value:"HTML_TEXT",label:"文本"},{value:"TARGET_LINK",label:"跳转链接"},{value:"NEXT_LINK",label:"下一页链接"},{value:"TEXT_LINK",label:"抓取的链接文本"},{value:"PURE_TEXT",label:"抓取的链接文本"},{value:"DOWNLOAD_LINK",label:"下载链接"}]}},created:function(){console.log(r.a),this.fetchData()},methods:{fetchData:function(){var e=this,t=this.$route.params.id;this.id=t,t&&i.a.get(t).then(function(t){e.formData=t.data,e.formData.pageStructure&&e.formData.pageStructure.forEach(function(e,t){e.index=t}),e.formData.websiteId&&l.a.get(e.formData.websiteId).then(function(t){e.$refs.websiteSelect.setData(t.data)})}),console.log("edit id : "+t)},handleCommit:function(){var e=this;this.$refs.formData.validate(function(t){if(!t)return console.log("error submit!!"),!1;e.loading=!0,e.id?i.a.edit(e.formData).then(function(t){e.loading=!1,e.$router.push({path:"/template/page"})}).catch(function(){e.loading=!1}):i.a.add(e.formData).then(function(t){e.loading=!1,e.$router.push({path:"/template/page"})}).catch(function(){e.loading=!1})})},handleWebsiteChange:function(e){this.formData.websiteId=e.id},handleTabsEdit:function(e,t){if("add"===t){null===this.formData.pageStructure&&(this.formData.pageStructure=[]);var a=++this.tabIndex,n=a+"";this.formData.pageStructure.push({title:"未命名",name:"未命名",url:"xxx",index:n,content:"New Tab content"}),this.editPageName=n}if("remove"===t){var i=this.formData.pageStructure,l=this.editPageName;l===e&&i.forEach(function(t,a){if(t.index===e){var n=i[a+1]||i[a-1];n&&(l=n.index)}}),this.editPageName=l,this.formData.pageStructure=i.filter(function(t){return t.index!==e})}},handleAddField:function(e){void 0!==e.fields&&null!==e.fields||n.default.set(e,"fields",[]),e.fields.push({type:""})}},components:{querySelect:r.a}}},267:function(e,t,a){t=e.exports=a(222)(!0),t.push([e.i,".tips{font-size:14px;color:#fff;margin-bottom:5px}.user-edit-container .svg-container{padding:6px 5px 6px 15px;color:#889aa4}.user-edit-container .login-form{left:0;right:0;width:500px;padding:35px 35px 15px;margin:20px auto}.user-edit-container .forget-pwd{color:#fff}.user-edit-container .page-template-edit{left:0;right:0;margin:20px auto;width:500px}","",{version:3,sources:["/Users/seveniu/project/self/TemplateCrawler/front/web/src/views/template/edit.vue"],names:[],mappings:"AACA,MACE,eAAgB,AAChB,WAAY,AACZ,iBAAmB,CACpB,AAkBD,oCACI,yBAA0B,AAC1B,aAAe,CAClB,AACD,iCAEI,OAAQ,AACR,QAAS,AACT,YAAa,AACb,uBAA6B,AAC7B,gBAAkB,CACrB,AAOD,iCACI,UAAY,CACf,AACD,yCACI,OAAQ,AACR,QAAS,AACT,iBAAkB,AAClB,WAAa,CAChB",file:"edit.vue",sourcesContent:['/*@import "src/styles/mixin.scss";*/\n.tips {\n  font-size: 14px;\n  color: #fff;\n  margin-bottom: 5px;\n}\n.user-edit-container {\n  /*@include relative;*/\n  /*height: 100vh;*/\n  /*background-color: #2d3a4b;*/\n  /*input:-webkit-autofill {*/\n  /*-webkit-box-shadow: 0 0 0px 1000px #293444 inset !important;*/\n  /*-webkit-text-fill-color: #fff !important;*/\n  /*}*/\n  /*.title {*/\n  /*font-size: 26px;*/\n  /*font-weight: 400;*/\n  /*color: #eeeeee;*/\n  /*margin: 0px auto 40px auto;*/\n  /*text-align: center;*/\n  /*font-weight: bold;*/\n  /*}*/\n}\n.user-edit-container .svg-container {\n    padding: 6px 5px 6px 15px;\n    color: #889aa4;\n}\n.user-edit-container .login-form {\n    /*position: absolute;*/\n    left: 0;\n    right: 0;\n    width: 500px;\n    padding: 35px 35px 15px 35px;\n    margin: 20px auto;\n}\n.user-edit-container .el-form-item {\n    /*border: 1px solid rgba(255, 255, 255, 0.1);*/\n    /*background: rgba(0, 0, 0, 0.1);*/\n    /*border-radius: 5px;*/\n    /*color: #454545;*/\n}\n.user-edit-container .forget-pwd {\n    color: #fff;\n}\n.user-edit-container .page-template-edit {\n    left: 0;\n    right: 0;\n    margin: 20px auto;\n    width: 500px;\n}\n'],sourceRoot:""}])},275:function(e,t,a){var n=a(267);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a(223)("2ccb520e",n,!0)},288:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user-edit-container"},[a("el-form",{ref:"formData",staticClass:"card-box login-form",attrs:{autoComplete:"on",model:e.formData,rules:e.loginRules,"label-position":"right","label-width":"80px"}},[a("h3",{staticClass:"title"},[e._v("编辑")]),e._v(" "),a("el-form-item",{attrs:{prop:"username",label:"模板名"}},[a("el-input",{attrs:{name:"name",type:"text",autoComplete:"on",placeholder:"模板名"},model:{value:e.formData.name,callback:function(t){e.formData.name=t},expression:"formData.name"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"username",label:"网站"}},[a("query-select",{ref:"websiteSelect",attrs:{api:e.websiteApi},on:{change:e.handleWebsiteChange}})],1),e._v(" "),a("el-form-item",[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:e.loading},nativeOn:{click:function(t){t.preventDefault(),e.handleCommit(t)}}},[e._v("\n        提交\n      ")])],1)],1),e._v(" "),a("el-tabs",{staticClass:"page-template-edit",attrs:{type:"card",editable:""},on:{edit:e.handleTabsEdit},model:{value:e.editPageName,callback:function(t){e.editPageName=t},expression:"editPageName"}},e._l(e.formData.pageStructure,function(t,n){return a("el-tab-pane",{key:n,attrs:{label:t.name,name:t.index+""}},[a("el-form",{attrs:{"label-position":"right","label-width":"80px"}},[a("el-form-item",{attrs:{label:"网页名称"}},[a("el-input",{attrs:{name:"name",type:"text",autoComplete:"on",placeholder:"当前页名称"},model:{value:t.name,callback:function(e){t.name=e},expression:"item.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"网页链接"}},[a("el-input",{attrs:{name:"name",type:"text",autoComplete:"on",placeholder:"网页链接"},model:{value:t.url,callback:function(e){t.url=e},expression:"item.url"}})],1),e._v(" "),a("el-form-item",[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:e.loading},nativeOn:{click:function(a){a.preventDefault(),e.handleAddField(t)}}},[e._v("\n            添加字段\n          ")])],1),e._v(" "),e._l(t.fields,function(t,n){return a("div",[a("el-form",{attrs:{"label-position":"right","label-width":"80px",model:t}},[a("el-form-item",{attrs:{label:"属性名"}},[a("el-input",{model:{value:t.name,callback:function(e){t.name=e},expression:"field.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"显示名"}},[a("el-input",{model:{value:t.label,callback:function(e){t.label=e},expression:"field.label"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"类型"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.type,callback:function(e){t.type=e},expression:"field.type"}},e._l(e.fieldType,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"默认值"}},[a("el-input",{model:{value:t.defaultValue,callback:function(e){t.defaultValue=e},expression:"field.defaultValue"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Xpath"}},[a("el-input",{model:{value:t.xpath,callback:function(e){t.xpath=e},expression:"field.xpath"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"多选"}},[a("el-checkbox",{model:{value:t.multiple,callback:function(e){t.multiple=e},expression:"field.multiple"}})],1)],1)],1)})],2)],1)}))],1)},staticRenderFns:[]}}});
//# sourceMappingURL=0.2957f2bb2fb6c03ff732.js.map